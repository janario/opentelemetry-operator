apiVersion: opentelemetry.io/v1alpha1
kind: OpenTelemetryCollector
metadata:
  name: ha
spec:
  mode: ($mode)
  replicas: 2
#  lifecycle:
#    preStop:
#      exec:
#        command:
#          - sleep
#          - '3'
#          - '1'
  config: |
    extensions:
      health_check:
        endpoint: ${POD_IP}:13133
    receivers:
      otlp:
        protocols:
          grpc:
          http:
    processors:

    exporters:
      debug:

    service:
      extensions:
        - health_check
      pipelines:
        traces:
          receivers: [otlp]
          processors: []
          exporters: [debug]